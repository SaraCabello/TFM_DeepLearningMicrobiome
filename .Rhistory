inbreds_original=as.data.frame(table(get_variable(data_nobulk, sample_variables(data_nobulk)[70])))
x_text=element_text(size = 0)
p2 <- ggplot(inbreds_original) + geom_col(aes(inbreds_original$Var1, inbreds_original$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS") + theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp_original=get_variable(data_nobulk, sample_variables(data_nobulk)[66])
p3 <- qplot(temp_original, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec_original=get_variable(data_nobulk, sample_variables(data_nobulk)[69])
p4 <- qplot(prec_original, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title1=textGrob("A) ORIGINAL SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot_original=grid.arrange(p1, p2, p3, p4, nrow=1, top = title1 )
age2save=get_variable(data2save, sample_variables(data2save)[59])
p5 <- qplot(age2save, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds2save=as.data.frame(table(get_variable(data2save, sample_variables(data2save)[70])))
p6 <- ggplot(inbreds2save) + geom_col(aes(inbreds2save$Var1, inbreds2save$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS")+ theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp2save=get_variable(data2save, sample_variables(data2save)[66])
p7 <- qplot(temp2save, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec2save=get_variable(data2save, sample_variables(data2save)[69])
p8 <- qplot(prec2save, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title2=textGrob("C) PREDICTIVE ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot2save=grid.arrange(p5, p6, p7, p8, nrow=1, top = title2 )
age2use=get_variable(data2use, sample_variables(data2use)[59])
p9 <- qplot(age2use, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds2use=as.data.frame(table(get_variable(data2use, sample_variables(data2use)[70])))
p10 <- ggplot(inbreds2use) + geom_col(aes(inbreds2use$Var1, inbreds2use$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS") + theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp2use=get_variable(data2use, sample_variables(data2use)[66])
p11 <- qplot(temp2use, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec2use=get_variable(data2use, sample_variables(data2use)[69])
p12 <- qplot(prec2use, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title2=textGrob("B) BASIC ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot2use=grid.arrange(p9, p10, p11, p12, nrow=1, top = title2 )
grid.arrange(plot_original, plot2use, plot2save)
grid.arrange(plot_original, plot2use, plot2save)
age2use=get_variable(data2use, sample_variables(data2use)[59])
p9 <- qplot(age2use, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds2use=as.data.frame(table(get_variable(data2use, sample_variables(data2use)[70])))
p10 <- ggplot(inbreds2use) + geom_col(aes(inbreds2use$Var1, inbreds2use$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS") + theme(axis.text.x=element_text(angle=80,hjust=1,size='5'), plot.title = element_text(size=22))
temp2use=get_variable(data2use, sample_variables(data2use)[66])
p11 <- qplot(temp2use, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec2use=get_variable(data2use, sample_variables(data2use)[69]) + theme(plot.title = element_text(size=22))
p12 <- qplot(prec2use, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title2=textGrob("B) BASIC ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20)) + theme(plot.title = element_text(size=22))
plot2use=grid.arrange(p9, p10, p11, p12, nrow=1, top = title2 )
age2use=get_variable(data2use, sample_variables(data2use)[59])
p9 <- qplot(age2use, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds2use=as.data.frame(table(get_variable(data2use, sample_variables(data2use)[70])))
p10 <- ggplot(inbreds2use) + geom_col(aes(inbreds2use$Var1, inbreds2use$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS") + theme(axis.text.x=element_text(angle=80,hjust=1,size='5'), plot.title = element_text(size=22))
temp2use=get_variable(data2use, sample_variables(data2use)[66])
p11 <- qplot(temp2use, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=22))
prec2use=get_variable(data2use, sample_variables(data2use)[69])
p12 <- qplot(prec2use, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=22))
title2=textGrob("B) BASIC ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot2use=grid.arrange(p9, p10, p11, p12, nrow=1, top = title2 )
grid.arrange(plot_original, plot2use, plot2save)
age2use=get_variable(data2use, sample_variables(data2use)[59])
p9 <- qplot(age2use, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=15))
inbreds2use=as.data.frame(table(get_variable(data2use, sample_variables(data2use)[70])))
p10 <- ggplot(inbreds2use) + geom_col(aes(inbreds2use$Var1, inbreds2use$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS") + theme(axis.text.x=element_text(angle=80,hjust=1,size='5'), plot.title = element_text(size=15))
temp2use=get_variable(data2use, sample_variables(data2use)[66])
p11 <- qplot(temp2use, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=15))
prec2use=get_variable(data2use, sample_variables(data2use)[69])
p12 <- qplot(prec2use, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=15))
title2=textGrob("B) BASIC ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot2use=grid.arrange(p9, p10, p11, p12, nrow=1, top = title2 )
grid.arrange(plot_original, plot2use, plot2save)
grid.arrange(plot_original, plot2use, plot2save)
age2use=get_variable(data2use, sample_variables(data2use)[59])
p9 <- qplot(age2use, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=12))
inbreds2use=as.data.frame(table(get_variable(data2use, sample_variables(data2use)[70])))
p10 <- ggplot(inbreds2use) + geom_col(aes(inbreds2use$Var1, inbreds2use$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'), plot.title = element_text(size=12))
temp2use=get_variable(data2use, sample_variables(data2use)[66])
p11 <- qplot(temp2use, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=12))
prec2use=get_variable(data2use, sample_variables(data2use)[69])
p12 <- qplot(prec2use, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=12))
title2=textGrob("B) BASIC ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot2use=grid.arrange(p9, p10, p11, p12, nrow=1, top = title2 )
grid.arrange(plot_original, plot2use, plot2save)
age_original=get_variable(data_nobulk, sample_variables(data_nobulk)[59])
p1 <- qplot(age_original, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
inbreds_original=as.data.frame(table(get_variable(data_nobulk, sample_variables(data_nobulk)[70])))
x_text=element_text(size = 0)
p2 <- ggplot(inbreds_original) + geom_col(aes(inbreds_original$Var1, inbreds_original$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'), plot.title = element_text(size=10))
temp_original=get_variable(data_nobulk, sample_variables(data_nobulk)[66])
p3 <- qplot(temp_original, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
prec_original=get_variable(data_nobulk, sample_variables(data_nobulk)[69])
p4 <- qplot(prec_original, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
title1=textGrob("A) ORIGINAL SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot_original=grid.arrange(p1, p2, p3, p4, nrow=1, top = title1 )
ge2save=get_variable(data2save, sample_variables(data2save)[59])
p5 <- qplot(age2save, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
inbreds2save=as.data.frame(table(get_variable(data2save, sample_variables(data2save)[70])))
p6 <- ggplot(inbreds2save) + geom_col(aes(inbreds2save$Var1, inbreds2save$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS")+
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'), plot.title = element_text(size=10))
temp2save=get_variable(data2save, sample_variables(data2save)[66])
p7 <- qplot(temp2save, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
prec2save=get_variable(data2save, sample_variables(data2save)[69])
p8 <- qplot(prec2save, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title2=textGrob("C) PREDICTIVE ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20)) +
theme(plot.title = element_text(size=10))
plot2save=grid.arrange(p5, p6, p7, p8, nrow=1, top = title2 )
age2use=get_variable(data2use, sample_variables(data2use)[59])
p9 <- qplot(age2use, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
inbreds2use=as.data.frame(table(get_variable(data2use, sample_variables(data2use)[70])))
p10 <- ggplot(inbreds2use) + geom_col(aes(inbreds2use$Var1, inbreds2use$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'), plot.title = element_text(size=10))
temp2use=get_variable(data2use, sample_variables(data2use)[66])
p11 <- qplot(temp2use, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
prec2use=get_variable(data2use, sample_variables(data2use)[69])
p12 <- qplot(prec2use, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
title2=textGrob("B) BASIC ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot2use=grid.arrange(p9, p10, p11, p12, nrow=1, top = title2 )
grid.arrange(plot_original, plot2use, plot2save)
age2save=get_variable(data2save, sample_variables(data2save)[59])
p5 <- qplot(age2save, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
inbreds2save=as.data.frame(table(get_variable(data2save, sample_variables(data2save)[70])))
p6 <- ggplot(inbreds2save) + geom_col(aes(inbreds2save$Var1, inbreds2save$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS")+
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'), plot.title = element_text(size=10))
temp2save=get_variable(data2save, sample_variables(data2save)[66])
p7 <- qplot(temp2save, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
prec2save=get_variable(data2save, sample_variables(data2save)[69])
p8 <- qplot(prec2save, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
title2=textGrob("C) PREDICTIVE ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot2save=grid.arrange(p5, p6, p7, p8, nrow=1, top = title2 )
grid.arrange(plot_original, plot2use, plot2save)
text=element_text(size = 0)
age_original=get_variable(data_nobulk, sample_variables(data_nobulk)[59])
p1 <- qplot(age_original, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(text))
inbreds_original=as.data.frame(table(get_variable(data_nobulk, sample_variables(data_nobulk)[70])))
p2 <- ggplot(inbreds_original) + geom_col(aes(inbreds_original$Var1, inbreds_original$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'), plot.title = element_text(text))
temp_original=get_variable(data_nobulk, sample_variables(data_nobulk)[66])
p3 <- qplot(temp_original, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(text))
prec_original=get_variable(data_nobulk, sample_variables(data_nobulk)[69])
p4 <- qplot(prec_original, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(text))
title1=textGrob("A) ORIGINAL SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot_original=grid.arrange(p1, p2, p3, p4, nrow=1, top = title1 )
plot_original=grid.arrange(p1, p2, p3, p4, nrow=1, top = title1 )
age_original=get_variable(data_nobulk, sample_variables(data_nobulk)[59])
p1 <- qplot(age_original, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(text))
inbreds_original=as.data.frame(table(get_variable(data_nobulk, sample_variables(data_nobulk)[70])))
p2 <- ggplot(inbreds_original) + geom_col(aes(inbreds_original$Var1, inbreds_original$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'), plot.title = element_text(text))
temp_original=get_variable(data_nobulk, sample_variables(data_nobulk)[66])
p3 <- qplot(temp_original, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(text))
prec_original=get_variable(data_nobulk, sample_variables(data_nobulk)[69])
p4 <- qplot(prec_original, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title1=textGrob("A) ORIGINAL SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot_original=grid.arrange(p1, p2, p3, p4, nrow=1, top = title1 )
p4 <- qplot(prec_original, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
p4
age_original=get_variable(data_nobulk, sample_variables(data_nobulk)[59])
p1 <- qplot(age_original, geom = "histogram", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds_original=as.data.frame(table(get_variable(data_nobulk, sample_variables(data_nobulk)[70])))
p2 <- ggplot(inbreds_original) + geom_col(aes(inbreds_original$Var1, inbreds_original$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp_original=get_variable(data_nobulk, sample_variables(data_nobulk)[66])
p3 <- qplot(temp_original, geom = "histogram", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec_original=get_variable(data_nobulk, sample_variables(data_nobulk)[69])
p4 <- qplot(prec_original, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title1=textGrob("A) ORIGINAL SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot_original=grid.arrange(p1, p2, p3, p4, nrow=1, top = title1 )
age_original=get_variable(data_nobulk, sample_variables(data_nobulk)[59])
p1 <- qplot(age_original, geom = "histogram", xlab = "Age", ylab='Frequency',fill = I("gray"), col=I("black"))
inbreds_original=as.data.frame(table(get_variable(data_nobulk, sample_variables(data_nobulk)[70])))
p2 <- ggplot(inbreds_original) + geom_col(aes(inbreds_original$Var1, inbreds_original$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp_original=get_variable(data_nobulk, sample_variables(data_nobulk)[66])
p3 <- qplot(temp_original, geom = "histogram", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec_original=get_variable(data_nobulk, sample_variables(data_nobulk)[69])
p4 <- qplot(prec_original, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title1=textGrob("A) ORIGINAL SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot_original=grid.arrange(p1, p2, p3, p4, nrow=1, top = title1 )
text=element_text(size = 0)
age_original=get_variable(data_nobulk, sample_variables(data_nobulk)[59])
p1 <- qplot(age_original, geom = "histogram", xlab = "Age", ylab='Frequency', fill = I("gray"), col=I("black"))
inbreds_original=as.data.frame(table(get_variable(data_nobulk, sample_variables(data_nobulk)[70])))
p2 <- ggplot(inbreds_original) + geom_col(aes(inbreds_original$Var1, inbreds_original$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = text) +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp_original=get_variable(data_nobulk, sample_variables(data_nobulk)[66])
p3 <- qplot(temp_original, geom = "histogram", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec_original=get_variable(data_nobulk, sample_variables(data_nobulk)[69])
p4 <- qplot(prec_original, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title1=textGrob("A) ORIGINAL SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot_original=grid.arrange(p1, p2, p3, p4, nrow=1, top = title1 )
age_original=get_variable(data_nobulk, sample_variables(data_nobulk)[59])
p1 <- qplot(age_original, geom = "histogram", xlab = "Age", ylab='Frequency', fill = I("gray"), col=I("black"))
inbreds_original=as.data.frame(table(get_variable(data_nobulk, sample_variables(data_nobulk)[70])))
p2 <- ggplot(inbreds_original) + geom_col(aes(inbreds_original$Var1, inbreds_original$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = 'Frequency') +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp_original=get_variable(data_nobulk, sample_variables(data_nobulk)[66])
p3 <- qplot(temp_original, geom = "histogram", xlab = "Temperature", ylab='Frequency', fill = I("gray"), col=I("black"))
prec_original=get_variable(data_nobulk, sample_variables(data_nobulk)[69])
p4 <- qplot(prec_original, geom = "histogram", xlab = "Precipitation3Days", ylab='Frequency', fill = I("gray"), col=I("black"))
title1=textGrob("A) ORIGINAL SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot_original=grid.arrange(p1, p2, p3, p4, nrow=1, top = title1 )
age_original=get_variable(data_nobulk, sample_variables(data_nobulk)[59])
p1 <- qplot(age_original, geom = "histogram", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds_original=as.data.frame(table(get_variable(data_nobulk, sample_variables(data_nobulk)[70])))
p2 <- ggplot(inbreds_original) + geom_col(aes(inbreds_original$Var1, inbreds_original$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = 'Frequency') +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp_original=get_variable(data_nobulk, sample_variables(data_nobulk)[66])
p3 <- qplot(temp_original, geom = "histogram", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec_original=get_variable(data_nobulk, sample_variables(data_nobulk)[69])
p4 <- qplot(prec_original, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title1=textGrob("A) ORIGINAL SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot_original=grid.arrange(p2, p1, p3, p4, nrow=1, top = title1 )
age2save=get_variable(data2save, sample_variables(data2save)[59])
p5 <- qplot(age2save, geom = "histogram", main="Histogram for variable AGE", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds2save=as.data.frame(table(get_variable(data2save, sample_variables(data2save)[70])))
p6 <- ggplot(inbreds2save) + geom_col(aes(inbreds2save$Var1, inbreds2save$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") + ggtitle("Value distribution for variable INBREDS")+
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp2save=get_variable(data2save, sample_variables(data2save)[66])
p7 <- qplot(temp2save, geom = "histogram", main="Histogram for variable Temperature", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec2save=get_variable(data2save, sample_variables(data2save)[69])
p8 <- qplot(prec2save, geom = "histogram", main="Histogram for variable Precipitation3Days", xlab = "Precipitation3Days", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
title2=textGrob("C) PREDICTIVE ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot2save=grid.arrange(p6, p5, p7, p8, nrow=1, top = title2 )
age2use=get_variable(data2use, sample_variables(data2use)[59])
p9 <- qplot(age2use, geom = "histogram", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds2use=as.data.frame(table(get_variable(data2use, sample_variables(data2use)[70])))
p10 <- ggplot(inbreds2use) + geom_col(aes(inbreds2use$Var1, inbreds2use$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp2use=get_variable(data2use, sample_variables(data2use)[66])
p11 <- qplot(temp2use, geom = "histogram", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec2use=get_variable(data2use, sample_variables(data2use)[69])
p12 <- qplot(prec2use, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title2=textGrob("B) BASIC ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot2use=grid.arrange(p9, p10, p11, p12, nrow=1, top = title2 )
age2use=get_variable(data2use, sample_variables(data2use)[59])
p9 <- qplot(age2use, geom = "histogram", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds2use=as.data.frame(table(get_variable(data2use, sample_variables(data2use)[70])))
p10 <- ggplot(inbreds2use) + geom_col(aes(inbreds2use$Var1, inbreds2use$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp2use=get_variable(data2use, sample_variables(data2use)[66])
p11 <- qplot(temp2use, geom = "histogram", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec2use=get_variable(data2use, sample_variables(data2use)[69])
p12 <- qplot(prec2use, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title2=textGrob("B) BASIC ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=20))
plot2use=grid.arrange(p10, p9, p11, p12, nrow=1, top = title2 )
grid.arrange(plot_original, plot2use, plot2save)
age_original=get_variable(data_nobulk, sample_variables(data_nobulk)[59])
p1 <- qplot(age_original, geom = "histogram", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds_original=as.data.frame(table(get_variable(data_nobulk, sample_variables(data_nobulk)[70])))
p2 <- ggplot(inbreds_original) + geom_col(aes(inbreds_original$Var1, inbreds_original$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = 'Frequency') +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp_original=get_variable(data_nobulk, sample_variables(data_nobulk)[66])
p3 <- qplot(temp_original, geom = "histogram", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec_original=get_variable(data_nobulk, sample_variables(data_nobulk)[69])
p4 <- qplot(prec_original, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title1=textGrob("A) ORIGINAL SUBSET", gp=gpar(fontface="bold", fontsize=15))
plot_original=grid.arrange(p2, p1, p3, p4, nrow=1, top = title1 )
age2save=get_variable(data2save, sample_variables(data2save)[59])
p5 <- qplot(age2save, geom = "histogram", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds2save=as.data.frame(table(get_variable(data2save, sample_variables(data2save)[70])))
p6 <- ggplot(inbreds2save) + geom_col(aes(inbreds2save$Var1, inbreds2save$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp2save=get_variable(data2save, sample_variables(data2save)[66])
p7 <- qplot(temp2save, geom = "histogram", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec2save=get_variable(data2save, sample_variables(data2save)[69])
p8 <- qplot(prec2save, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
title2=textGrob("C) PREDICTIVE ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=15))
plot2save=grid.arrange(p6, p5, p7, p8, nrow=1, top = title2 )
age2use=get_variable(data2use, sample_variables(data2use)[59])
p9 <- qplot(age2use, geom = "histogram", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds2use=as.data.frame(table(get_variable(data2use, sample_variables(data2use)[70])))
p10 <- ggplot(inbreds2use) + geom_col(aes(inbreds2use$Var1, inbreds2use$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp2use=get_variable(data2use, sample_variables(data2use)[66])
p11 <- qplot(temp2use, geom = "histogram", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec2use=get_variable(data2use, sample_variables(data2use)[69])
p12 <- qplot(prec2use, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black"))
title2=textGrob("B) BASIC ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=15))
plot2use=grid.arrange(p10, p9, p11, p12, nrow=1, top = title2 )
grid.arrange(plot_original, plot2use, plot2save)
age2save=get_variable(data2save, sample_variables(data2save)[59])
p5 <- qplot(age2save, geom = "histogram", xlab = "Age", fill = I("gray"), col=I("black"))
inbreds2save=as.data.frame(table(get_variable(data2save, sample_variables(data2save)[70])))
p6 <- ggplot(inbreds2save) + geom_col(aes(inbreds2save$Var1, inbreds2save$Freq), fill = I("gray"), col=I("black")) +
labs (x = "Inbred", y = "Frequency") +
theme(axis.text.x=element_text(angle=80,hjust=1,size='5'))
temp2save=get_variable(data2save, sample_variables(data2save)[66])
p7 <- qplot(temp2save, geom = "histogram", xlab = "Temperature", fill = I("gray"), col=I("black"))
prec2save=get_variable(data2save, sample_variables(data2save)[69])
p8 <- qplot(prec2save, geom = "histogram", xlab = "Precipitation3Days", fill = I("gray"), col=I("black")) +
theme(plot.title = element_text(size=10))
title2=textGrob("C) PREDICTIVE ENCODER SUBSET", gp=gpar(fontface="bold", fontsize=15))
plot2save=grid.arrange(p6, p5, p7, p8, nrow=1, top = title2 )
grid.arrange(plot_original, plot2use, plot2save)
#load original data
train_or = read.table('./Models/Maize/model2/data_predictor/2otu_table2save_80_ytrain80_norm.csv', sep='\t', header = TRUE)
rownames(train_or) = train_or$X.SampleID
train_or$X.SampleID = NULL
train_or$X.SampleID.1 = NULL
test_or = read.table('./Models/Maize/model2/data_predictor/2otu_table2save_80_ytest20_norm.csv', sep='\t', header = TRUE)
rownames(test_or) = test_or$X.SampleID
test_or$X.SampleID = NULL
test_or$X.SampleID.1 = NULL
setwd('/Volumes/USB\ DISK')
#load original data
train_or = read.table('./Models/Maize/model2/data_predictor/2otu_table2save_80_ytrain80_norm.csv', sep='\t', header = TRUE)
rownames(train_or) = train_or$X.SampleID
train_or$X.SampleID = NULL
train_or$X.SampleID.1 = NULL
test_or = read.table('./Models/Maize/model2/data_predictor/2otu_table2save_80_ytest20_norm.csv', sep='\t', header = TRUE)
rownames(test_or) = test_or$X.SampleID
test_or$X.SampleID = NULL
test_or$X.SampleID.1 = NULL
default_analysis = function (original_otutable_train, original_otutable_test){
default_otutable_train=NULL
for (i in (1:ncol(original_otutable_train))){
otu_abundance=as.numeric(original_otutable_train[,i])
mean_value=mean(otu_abundance)
new_column=rep.int(mean_value, nrow(original_otutable_train))
default_otutable_train=cbind(default_otutable_train, new_column)
}
colnames(default_otutable_train) = colnames(original_otutable_train)
row.names(default_otutable_train) = row.names(original_otutable_train)
default_otutable_test = NULL
for (i in (1:ncol(original_otutable_test))){
otu_id=colnames(original_otutable_test)[i]
mean_value= mean(as.numeric(default_otutable_train[,i]))
new_column=rep.int(mean_value, nrow(original_otutable_test))
default_otutable_test=cbind(default_otutable_test, new_column)
}
colnames(default_otutable_test) = colnames(original_otutable_test)
row.names(default_otutable_test) = row.names(original_otutable_test)
return(default_otutable_test)
}
default_otutable_test = default_predictor(train_or, test_or)
default_predictor = function (original_otutable_train, original_otutable_test){
default_otutable_train=NULL
for (i in (1:ncol(original_otutable_train))){
otu_abundance=as.numeric(original_otutable_train[,i])
mean_value=mean(otu_abundance)
new_column=rep.int(mean_value, nrow(original_otutable_train))
default_otutable_train=cbind(default_otutable_train, new_column)
}
colnames(default_otutable_train) = colnames(original_otutable_train)
row.names(default_otutable_train) = row.names(original_otutable_train)
default_otutable_test = NULL
for (i in (1:ncol(original_otutable_test))){
otu_id=colnames(original_otutable_test)[i]
mean_value= mean(as.numeric(default_otutable_train[,i]))
new_column=rep.int(mean_value, nrow(original_otutable_test))
default_otutable_test=cbind(default_otutable_test, new_column)
}
colnames(default_otutable_test) = colnames(original_otutable_test)
row.names(default_otutable_test) = row.names(original_otutable_test)
return(default_otutable_test)
}
#load original data
train_or = read.table('./Models/Maize/model2/data_predictor/2otu_table2save_80_ytrain80_norm.csv', sep='\t', header = TRUE)
rownames(train_or) = train_or$X.SampleID
train_or$X.SampleID = NULL
train_or$X.SampleID.1 = NULL
test_or = read.table('./Models/Maize/model2/data_predictor/2otu_table2save_80_ytest20_norm.csv', sep='\t', header = TRUE)
rownames(test_or) = test_or$X.SampleID
test_or$X.SampleID = NULL
test_or$X.SampleID.1 = NULL
default_otutable_test = default_predictor(train_or, test_or)
View(default_otutable_test)
default_predictor = function (original_otutable_train, original_otutable_test){
default_otutable_train=NULL
for (i in (1:ncol(original_otutable_train))){
otu_abundance=as.numeric(original_otutable_train[,i])
mean_value=mean(otu_abundance)
new_column=rep.int(mean_value, nrow(original_otutable_train))
default_otutable_train=cbind(default_otutable_train, new_column)
}
colnames(default_otutable_train) = colnames(original_otutable_train)
row.names(default_otutable_train) = row.names(original_otutable_train)
default_otutable_test = NULL
for (i in (1:ncol(original_otutable_test))){
otu_id=colnames(original_otutable_test)[i]
mean_value= mean(as.numeric(default_otutable_train[,i]))
new_column=rep.int(mean_value, nrow(original_otutable_test))
default_otutable_test=cbind(default_otutable_test, new_column)
}
colnames(default_otutable_test) = colnames(original_otutable_test)
row.names(default_otutable_test) = row.names(original_otutable_test)
default_otutable_train = cbind(colnames(default_otutable_train), default_otutable_train)
write.table(default_otutable_train, './data/transformed_data/default_predictor/default_otutable_train.csv', sep='\t', col.names=TRUE, row.names = FALSE)
default_otutable_test = cbind(colnames(default_otutable_test), default_otutable_test)
write.table(default_otutable_test, './data/transformed_data/default_predictor/default_otutable_test.csv', sep='\t', col.names=TRUE, row.names = FALSE)
}
default_otutable_test = default_predictor(train_or, test_or)
train_or = read.table('./data/original_data/data_train_predictivemodel/2otu_table2save_80_ytrain80_norm.csv', sep='\t', header = TRUE)
setwd('/Volumes/USB\ DISK/TFM_DeepLearningMicrobiome')
train_or = read.table('./data/original_data/data_train_predictivemodel/2otu_table2save_80_ytrain80_norm.csv', sep='\t', header = TRUE)
rownames(train_or) = train_or$X.SampleID
train_or$X.SampleID = NULL
train_or$X.SampleID.1 = NULL
test_or = read.table('./data/original_data/data_train_predictivemodel/2otu_table2save_80_ytest20_norm.csv', sep='\t', header = TRUE)
rownames(test_or) = test_or$X.SampleID
test_or$X.SampleID = NULL
test_or$X.SampleID.1 = NULL
default_predictor(train_or, test_or)
default_predictor = function (original_otutable_train, original_otutable_test){
default_otutable_train=NULL
for (i in (1:ncol(original_otutable_train))){
otu_abundance=as.numeric(original_otutable_train[,i])
mean_value=mean(otu_abundance)
new_column=rep.int(mean_value, nrow(original_otutable_train))
default_otutable_train=cbind(default_otutable_train, new_column)
}
colnames(default_otutable_train) = colnames(original_otutable_train)
row.names(default_otutable_train) = row.names(original_otutable_train)
default_otutable_test = NULL
for (i in (1:ncol(original_otutable_test))){
otu_id=colnames(original_otutable_test)[i]
mean_value= mean(as.numeric(default_otutable_train[,i]))
new_column=rep.int(mean_value, nrow(original_otutable_test))
default_otutable_test=cbind(default_otutable_test, new_column)
}
colnames(default_otutable_test) = colnames(original_otutable_test)
row.names(default_otutable_test) = row.names(original_otutable_test)
default_otutable_train = cbind(row.names(default_otutable_train), default_otutable_train)
write.table(default_otutable_train, './data/transformed_data/default_predictor/default_otutable_train.csv', sep='\t', col.names=TRUE, row.names = FALSE)
default_otutable_test = cbind(row.names(default_otutable_test), default_otutable_test)
write.table(default_otutable_test, './data/transformed_data/default_predictor/default_otutable_test.csv', sep='\t', col.names=TRUE, row.names = FALSE)
}
default_predictor(train_or, test_or)
path='./data/transformed_data/predictive_model/best_model/'
file='/table2save_otustest.csv'
data = read.table(paste(path, file, sep=''), sep='\t', header = TRUE)
setwd('/Volumes/USB\ DISK/TFM_DeepLearningMicrobiome')
path='./data/transformed_data/predictive_model/best_model/'
file='/table2save_otustest.csv'
data = read.table(paste(path, file, sep=''), sep='\t', header = TRUE)
table = as.data.frame(data$Rank2)
suma = sum(table$Freq)
table$Freq = (table$Freq/suma) * 100
table = as.data.frame(data$Rank2)
table
table = as.data.frame(table(data$Rank2))
table
suma = sum(table$Freq)
table$Freq = (table$Freq/suma) * 100
p1 <- ggplot(table, aes(x='', y=Freq, fill=Var1))+
geom_bar(width=1, stat='identity') +
coord_polar('y', start=0) +
guides(fill = guide_legend(title=rank_name)) +
theme(axis.title=element_blank(), plot.title = element_text(size=15, face="bold"))   +
labs (title='Phylum distribution of all OTUs')
p1
library(ggplot2)
library(dplyr)
library(ggplot2)
library(scales)
p1 <- ggplot(table, aes(x='', y=Freq, fill=Var1))+
geom_bar(width=1, stat='identity') +
coord_polar('y', start=0) +
guides(fill = guide_legend(title=rank_name)) +
theme(axis.title=element_blank(), plot.title = element_text(size=15, face="bold"))   +
labs (title='Phylum distribution of all OTUs')
p1 <- ggplot(table, aes(x='', y=Freq, fill=Var1))+
geom_bar(width=1, stat='identity') +
coord_polar('y', start=0) +
guides(fill = guide_legend(title='Phylum')) +
theme(axis.title=element_blank(), plot.title = element_text(size=15, face="bold"))   +
labs (title='Phylum distribution of all OTUs')
p1
